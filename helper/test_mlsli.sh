#!/bin/sh

ts=`date +%s`

curl "http://www.mlsli.com/Include/AJAX/MapSearch/GetListingPins.aspx?searchoverride=b7e708fb-30b5-4e82-83d3-e713e874ef9f&ts=${ts}875&" -H 'Host: www.mlsli.com' -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:53.0) Gecko/20100101 Firefox/53.0' -H 'Accept: application/json, text/javascript, */*; q=0.01' -H 'Accept-Language: en-US,en;q=0.5' --compressed -H 'X-Distil-Ajax: varydvdued' -H 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' -H 'X-Form: {"Criteria/FilterByAddress":["1"],"AutoAdjustMap":["on"],"Criteria/ListingTypeID":["1"],"Criteria/MinPrice":["$500,000"],"Criteria/MaxPrice":["$1,500,000"],"Criteria/PropertyTypeID":["0x000000000000000000000002"],"Criteria/Status":["1,5"],"Criteria/LocationJson":["[[{\"name\":\"Setauket, NY (City)\",\"type\":\"City\",\"value\":\"Setauket, NY (City)\",\"isNot\":false}]]"],"Criteria/SearchMapNELat":40.98460463075779,"Criteria/SearchMapNELong":-73.00518798828128,"Criteria/SearchMapSWLat":40.868394510317216,"Criteria/SearchMapSWLong":-73.21804809570315,"Criteria/Zoom":12,"Criteria/SearchMapStyle":"r","IgnoreMap":false,"ListingSortID":6,"view":"list","first":0,"Criteria/SearchType":"map","SearchTab":"mapsearch-criteria-basicsearch","CLSID":-1,"ResultsPerPage":10}' -H 'X-Requested-With: XMLHttpRequest' -H 'Referer: http://www.mlsli.com/Listing/ListingSearch.aspx' -H 'Cookie: ASP.NET_SessionId=okacwf43tupj4kjdqf2tfzt4; ExternalReferrer=https://www.google.com/; rBW-ListingSearch=b7e708fb-30b5-4e82-83d3-e713e874ef9f; BrokerOffice_Session=SessionCookie=a67816d9-be96-4e7f-97e6-171bcb83980d; BrokerOffice_Visit=0=0a5e86f9-dcbf-477e-b456-1946b375b1d7&1=1224-0-0-False; MLSLI_tc=1; MLSLI_MobilePopup=1; _ga=GA1.2.236589968.1498249286; _gid=GA1.2.1037564696.1498249286; D_IID=9846869A-A892-3911-8DCD-5E52E44787F7; D_UID=B8CEA6B8-6F23-3912-A284-E1A5AE1B7345; D_ZID=C95F2DD2-ADE1-3FAB-8A3A-881393FFEF63; D_ZUID=64077D58-C22C-388B-8AEB-591752497BA7; D_HID=6E2173D4-2B83-3896-9782-65E37B844713; D_SID=216.223.243.45:QadKVcXAbt/dahzXUHstnEhavvt0lN8+qpX9rbNwgfM; __utma=119517141.236589968.1498249286.1498249287.1498249287.1; __utmb=119517141.8.10.1498249287; __utmc=119517141; __utmz=119517141.1498249287.1.1.utmcsr=reachlocal|utmccn=search|utmcmd=cpc|utmctr=(not%20provided); rBW-IpLocation=%257b%2522IPAddressFrom%2522%253a%2522216.223.240.0%2522%252c%2522IPAddressTo%2522%253a%2522216.223.255.255%2522%252c%2522CountryCode%2522%253a%2522US%2522%252c%2522State%2522%253a%2522New%2BYork%2522%252c%2522City%2522%253a%2522Setauket-East%2BSetauket%2522%252c%2522Latitude%2522%253a40.9315%252c%2522Longitude%2522%253a-73.111%252c%2522Timezone%2522%253a%2522America%252fNew_York%2522%252c%2522Pin%2522%253a%257b%2522Lat%2522%253a40.93149948%252c%2522Lon%2522%253a-73.11100006%257d%257d; rBW-CompareListings=0d397aa2-67aa-4ce7-8ac6-7cb5fadc7cbf; PrevSearchSection=ListingSearch; dmp-key=%2Fdc1%2F_T193%2F13c99d24-c59f-42b5-91c6-71c4fd95d598_M-101164_333359; _gat_adWrapperTracker=1' -H 'Connection: keep-alive' -H 'Cache-Control: max-age=0' --data 'Criteria%2FFilterByAddress=1&AutoAdjustMap=on&Criteria%2FListingTypeID=1&Criteria%2FMinPrice=%24500%2C000&Criteria%2FMaxPrice=%241%2C500%2C000&Criteria%2FPropertyTypeID=0x000000000000000000000002&Criteria%2FStatus=1%2C5&Criteria%2FLocationJson=%5B%5B%7B%22name%22%3A%22Setauket%2C+NY+(City)%22%2C%22type%22%3A%22City%22%2C%22value%22%3A%22Setauket%2C+NY+(City)%22%2C%22isNot%22%3Afalse%7D%5D%5D&Criteria%2FSearchMapNELat=40.98460463075779&Criteria%2FSearchMapNELong=-73.00518798828128&Criteria%2FSearchMapSWLat=40.868394510317216&Criteria%2FSearchMapSWLong=-73.21804809570315&Criteria%2FZoom=12&Criteria%2FSearchMapStyle=r&IgnoreMap=false&ListingSortID=6&view=list&first=0&Criteria%2FSearchType=map&SearchTab=mapsearch-criteria-basicsearch&CLSID=-1&ResultsPerPage=10' > test_index.data

# curl 'http://www.mlsli.com/Include/AJAX/MapSearch/GetListingPins.aspx?searchoverride=21a8d3df-61d2-4115-91da-10a9d216abe2&ts=1500917125217&' -H 'Host: www.mlsli.com' -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:54.0) Gecko/20100101 Firefox/54.0' -H 'Accept: application/json, text/javascript, */*; q=0.01' -H 'Accept-Language: en-US,en;q=0.5' --compressed -H 'Referer: http://www.mlsli.com/Listing/ListingSearch.aspx' -H 'X-Distil-Ajax: cqrzdfrrdfux' -H 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' -H 'X-Form: {"Criteria/FilterByAddress":["1"],"AutoAdjustMap":["on"],"Criteria/ListingTypeID":["1"],"Criteria/MaxPrice":["$100,000,000"],"Criteria/PropertyTypeID":["0x000000000000000000000002"],"Criteria/Status":["1,5","2"],"Criteria/LocationJson":["[[{\"name\":\"Three Village Central School District, NY (School District)\",\"type\":\"School District\",\"value\":\"NY-THREE VI-11566\",\"isNot\":false}]]"],"Criteria/SearchMapNELat":41.03998268093979,"Criteria/SearchMapNELong":-72.89894104003902,"Criteria/SearchMapSWLat":40.8075531319012,"Criteria/SearchMapSWLong":-73.32466125488277,"Criteria/Zoom":11,"Criteria/SearchMapStyle":"r","IgnoreMap":false,"ListingSortID":6,"view":"list","first":0,"Criteria/SearchType":"map","SearchTab":"mapsearch-criteria-basicsearch","CLSID":-1,"ResultsPerPage":10}' -H 'X-Requested-With: XMLHttpRequest' -H 'Cookie: BrokerOffice_Session=SessionCookie=a67816d9-be96-4e7f-97e6-171bcb83980d; _ga=GA1.2.236589968.1498249286; D_SID=216.223.243.119:zIIXN1U5gPZ1JwZeyUN57bFUUhZceZZE+QypSPR+A3E; __utma=119517141.236589968.1498249286.1500911589.1500915150.3; __utmz=119517141.1498249287.1.1.utmcsr=reachlocal|utmccn=search|utmcmd=cpc|utmctr=(not%20provided); ASP.NET_SessionId=nk1la3jahzxvwtz3a25lx4lk; ExternalReferrer=; rBW-ListingSearch=21a8d3df-61d2-4115-91da-10a9d216abe2; BrokerOffice_Visit=0=c456d055-8967-4b09-910a-f26951a60d28&1=1224-0-0-False; _gid=GA1.2.70223099.1500911588; MLSLI_tc=1; MLSLI_MobilePopup=1; __utmc=119517141; D_IID=71FC3A37-EA91-3C28-A5EF-56E4DD48DB63; D_UID=DD4B35DB-2B93-33CF-9D6D-5968DA1BE8C5; D_ZID=11613518-1A4C-35B5-8007-6851AAE0565E; D_ZUID=2D72399B-3CF4-353F-8FAF-D7A875188928; D_HID=266E733E-0819-3C1D-8FCD-5A2885828201; rBW-CompareListings=3aa874e4-2930-4b6b-bf61-338b85cb09a5; PrevSearchSection=ListingSearch; .publicauth=; Sml-Login-Action=http%253A%252F%252Fwww.mlsli.com%252FListing%252FListingSearch.aspx%25253F%252526search%253D21a8d3df-61d2-4115-91da-10a9d216abe2%252526nextaction%253DSaveSearch; Sml-Original-Host=http%3A%2F%2Fwww.mlsli.com; Sml-Original-Path=%2FListing%2FListingSearch.aspx; rBW-IpLocation=%257b%2522IPAddressFrom%2522%253a%2522216.223.240.0%2522%252c%2522IPAddressTo%2522%253a%2522216.223.255.255%2522%252c%2522CountryCode%2522%253a%2522US%2522%252c%2522State%2522%253a%2522New%2BYork%2522%252c%2522City%2522%253a%2522Setauket-East%2BSetauket%2522%252c%2522Latitude%2522%253a40.9315%252c%2522Longitude%2522%253a-73.111%252c%2522Timezone%2522%253a%2522America%252fNew_York%2522%252c%2522Pin%2522%253a%257b%2522Lat%2522%253a40.93149948%252c%2522Lon%2522%253a-73.11100006%257d%257d; _gat_adWrapperTracker=1; dmp-key=%2Fdc2%2F_T99%2F7912b096-33d9-4cb4-9c6c-ca230a290a93_M-101164_333359' -H 'Connection: keep-alive' -H 'Cache-Control: max-age=0' --data 'Criteria%2FFilterByAddress=1&AutoAdjustMap=on&Criteria%2FListingTypeID=1&Criteria%2FMaxPrice=%24100%2C000%2C000&Criteria%2FPropertyTypeID=0x000000000000000000000002&Criteria%2FStatus=1%2C5&Criteria%2FStatus=2&Criteria%2FLocationJson=%5B%5B%7B%22name%22%3A%22Three+Village+Central+School+District%2C+NY+(School+District)%22%2C%22type%22%3A%22School+District%22%2C%22value%22%3A%22NY-THREE+VI-11566%22%2C%22isNot%22%3Afalse%7D%5D%5D&Criteria%2FSearchMapNELat=41.03998268093979&Criteria%2FSearchMapNELong=-72.89894104003902&Criteria%2FSearchMapSWLat=40.8075531319012&Criteria%2FSearchMapSWLong=-73.32466125488277&Criteria%2FZoom=11&Criteria%2FSearchMapStyle=r&IgnoreMap=false&ListingSortID=6&view=list&first=0&Criteria%2FSearchType=map&SearchTab=mapsearch-criteria-basicsearch&CLSID=-1&ResultsPerPage=10' > test_index.data


# curl 'http://www.mlsli.com/homes-for-sale/18-Lake-St-Setauket-NY-11733-150730221' -H 'Host: www.mlsli.com' -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:53.0) Gecko/20100101 Firefox/53.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H 'Accept-Language: en-US,en;q=0.5' --compressed -H 'Cookie: ASP.NET_SessionId=okacwf43tupj4kjdqf2tfzt4; ExternalReferrer=https://www.google.com/; rBW-ListingSearch=b7e708fb-30b5-4e82-83d3-e713e874ef9f; BrokerOffice_Session=SessionCookie=a67816d9-be96-4e7f-97e6-171bcb83980d; BrokerOffice_Visit=0=0a5e86f9-dcbf-477e-b456-1946b375b1d7&1=1224-0-0-False; MLSLI_tc=1; MLSLI_MobilePopup=1; _ga=GA1.2.236589968.1498249286; _gid=GA1.2.1037564696.1498249286; D_IID=9846869A-A892-3911-8DCD-5E52E44787F7; D_UID=B8CEA6B8-6F23-3912-A284-E1A5AE1B7345; D_ZID=C95F2DD2-ADE1-3FAB-8A3A-881393FFEF63; D_ZUID=64077D58-C22C-388B-8AEB-591752497BA7; D_HID=6E2173D4-2B83-3896-9782-65E37B844713; D_SID=216.223.243.45:QadKVcXAbt/dahzXUHstnEhavvt0lN8+qpX9rbNwgfM; __utma=119517141.236589968.1498249286.1498249287.1498249287.1; __utmb=119517141.16.10.1498249287; __utmc=119517141; __utmz=119517141.1498249287.1.1.utmcsr=reachlocal|utmccn=search|utmcmd=cpc|utmctr=(not%20provided); rBW-IpLocation=%257b%2522IPAddressFrom%2522%253a%2522216.223.240.0%2522%252c%2522IPAddressTo%2522%253a%2522216.223.255.255%2522%252c%2522CountryCode%2522%253a%2522US%2522%252c%2522State%2522%253a%2522New%2BYork%2522%252c%2522City%2522%253a%2522Setauket-East%2BSetauket%2522%252c%2522Latitude%2522%253a40.9315%252c%2522Longitude%2522%253a-73.111%252c%2522Timezone%2522%253a%2522America%252fNew_York%2522%252c%2522Pin%2522%253a%257b%2522Lat%2522%253a40.93149948%252c%2522Lon%2522%253a-73.11100006%257d%257d; rBW-CompareListings=0d397aa2-67aa-4ce7-8ac6-7cb5fadc7cbf; PrevSearchSection=ListingSearch; _ListingID=150730221; __utmt=1; dmp-key=%2Fdc2%2F_T99%2F67b23006-b109-4931-bcfa-708d97eaff27_M-101164_333359' -H 'Connection: keep-alive' -H 'Upgrade-Insecure-Requests: 1' > test_1.html


